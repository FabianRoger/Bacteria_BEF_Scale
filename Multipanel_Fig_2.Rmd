---
title: "script to make multipanel figure 2"
output: html_notebook
---

```{r}
library(ggplot2)
library(here)
library(cowplot)
library(gridExtra)
```


```{r}

load(here("figures", "Fig_2_a.RData"))
load(here("figures", "Fig_2_b.RData"))
load(here("figures", "Fig_2_c.RData"))
load(here("figures", "Fig_2_d.RData"))
load(here("figures", "Fig_2_e.RData"))
load(here("figures", "Fig_2_f.RData"))

Fig_2_a <- Fig_2_a +
  theme(legend.position = "none")

Fig_2_b <- Fig_2_b +
  theme(legend.position ="none")+
  labs(y = "")

legend <- get_legend(
  # create some space to the left of the legend
  Fig_2_a + 
    guides(color = guide_legend(nrow = 1))+
    theme(legend.position = "bottom")+
    theme(legend.box.margin = margin(0, 0, 0, 0))
)

p1 <- plot_grid(Fig_2_a, Fig_2_b)
p1 <- plot_grid(p1, legend, ncol = 1,  rel_heights = c(1, .1))
p2 <- plot_grid(Fig_2_c, Fig_2_e, Fig_2_d, Fig_2_f)
p2 <- plot_grid(p2, legend, ncol = 1,  rel_heights = c(1, .1))
p3 <- plot_grid(Fig_2_d, Fig_2_f)
p3 <- plot_grid(p3, legend, ncol = 1,  rel_heights = c(1, .1))

ggsave(plot = p1, filename = here("figures", "Fig_2_r1.pdf"), width = 6, height = 3)
ggsave(plot = p2, filename = here("figures", "Fig_2_r2.pdf"), width = 6, height = 3)
ggsave(plot = p3, filename = here("figures", "Fig_2_r3.pdf"), width = 6, height = 3)


p1
p2
p3

ggsave(plot = p, filename = here("figures", "Fig_2.pdf"), width = 6, height = 9)


```

